(window.webpackJsonpclient=window.webpackJsonpclient||[]).push([[18],{174:function(n,e,t){"use strict";var i=t(0);e.a=function(n){Object(i.useEffect)((function(){document.title=n}),[n])}},179:function(n,e,t){"use strict";var i=t(0),a=t.n(i),r=t(7),c=t(8),o=t(3);function u(){var n=Object(r.a)(["\n    width: 100%;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n"]);return u=function(){return n},n}function l(){var n=Object(r.a)(["\n    display: inline-block;\n    position: relative;\n    width: 64px;\n    height: 64px;\n    z-index: 1000;\n    div {\n        position: absolute;\n        top: 27px;\n        width: 11px;\n        height: 11px;\n        border-radius: 50%;\n        background: ",";\n        animation-timing-function: cubic-bezier(0, 1, 1, 0);\n    }\n    div:nth-child(1) {\n        left: 6px;\n        animation: lds-ellipsis1 0.6s infinite;\n    }\n    div:nth-child(2) {\n        left: 6px;\n        animation: lds-ellipsis2 0.6s infinite;\n    }\n    div:nth-child(3) {\n        left: 26px;\n        animation: lds-ellipsis2 0.6s infinite;\n    }\n    div:nth-child(4) {\n        left: 45px;\n        animation: lds-ellipsis3 0.6s infinite;\n    }\n    @keyframes lds-ellipsis1 {\n        0% {\n            transform: scale(0);\n        }\n        100% {\n            transform: scale(1);\n        }\n    }\n    @keyframes lds-ellipsis3 {\n        0% {\n            transform: scale(1);\n        }\n        100% {\n            transform: scale(0);\n        }\n    }\n    @keyframes lds-ellipsis2 {\n        0% {\n            transform: translate(0, 0);\n        }\n        100% {\n            transform: translate(19px, 0);\n        }\n    }\n"]);return l=function(){return n},n}var s=c.c.div(l(),o.b.blue),d=c.c.div(u());e.a=function(){return a.a.createElement(d,null,a.a.createElement(s,null,a.a.createElement("div",null),a.a.createElement("div",null),a.a.createElement("div",null),a.a.createElement("div",null)))}},275:function(n,e,t){"use strict";t.d(e,"d",(function(){return m})),t.d(e,"f",(function(){return g})),t.d(e,"e",(function(){return v})),t.d(e,"g",(function(){return p})),t.d(e,"a",(function(){return h})),t.d(e,"c",(function(){return b})),t.d(e,"b",(function(){return E}));var i=t(7),a=t(8),r=t(3);function c(){var n=Object(i.a)(["\n    display: flex;\n    align-items: center;\n"]);return c=function(){return n},n}function o(){var n=Object(i.a)(["\n\n"]);return o=function(){return n},n}function u(){var n=Object(i.a)(["\n\n"]);return u=function(){return n},n}function l(){var n=Object(i.a)(["\n\n"]);return l=function(){return n},n}function s(){var n=Object(i.a)(["\n    \n"]);return s=function(){return n},n}function d(){var n=Object(i.a)(["\n    margin-left: 1rem;\n"]);return d=function(){return n},n}function f(){var n=Object(i.a)(["\n    position: relative;\n    border-left: 1px solid #eee;\n    min-height: calc(100vh - ",");\n    padding: 0.5rem;\n\n    @media (max-width: ",") {\n        min-height: auto;\n    }\n"]);return f=function(){return n},n}var m=a.c.div(f(),r.e,r.a.md),g=a.c.div(d()),v=a.c.div(s()),p=a.c.div(l()),h=a.c.div(u()),b=a.c.div(o()),E=a.c.div(c())},682:function(n,e,t){"use strict";t.r(e);var i=t(33),a=t(0),r=t.n(a),c=t(7),o=t(8),u=t(3);function l(){var n=Object(c.a)(["\n    border-radius: 6rem;\n    border: 1px solid #ddd;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    margin: 0.5rem;\n    width: 6rem;\n    height: 6rem;\n    font-size: 2.8rem;\n    background: white;\n    color: ",";\n    cursor: pointer;\n"]);return l=function(){return n},n}function s(){var n=Object(c.a)(["\n    margin-top: 1rem;\n    padding-top: 1rem;\n    border-top: 1px solid #ddd;\n    display: flex;\n"]);return s=function(){return n},n}function d(){var n=Object(c.a)(["\n    \n"]);return d=function(){return n},n}function f(){var n=Object(c.a)(["\n    font-weight: bold;\n    font-size: 1.8rem;\n"]);return f=function(){return n},n}function m(){var n=Object(c.a)(["\n    border: 1px solid #ccc;\n    position: absolute;\n    bottom: 0.5rem;\n    right: 0.5rem;\n    height: 20%;\n    filter: opacity(1);\n    background: #0f0f0f;\n\n    @media (max-width: ",") {\n        height: 25%;\n    }\n"]);return m=function(){return n},n}function g(){var n=Object(c.a)(["\n    position: absolute;\n    top: 50%; \n    left: 50%;\n    transform: translateX(-50%) translateY(-50%);\n    min-width: 100%; \n    min-height: 100%; \n    width: auto; \n    height: auto;\n    z-index: -1000; \n    overflow: hidden;\n"]);return g=function(){return n},n}function v(){var n=Object(c.a)(["\n    position: relative;\n    height: 100%;\n    box-sizing: border-box;\n    overflow: hidden;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n\n    @media (max-width: ",") {\n        width: 100%;\n        height: 60vh;\n    }\n"]);return v=function(){return n},n}function p(){var n=Object(c.a)(["\n    position: relative;\n    height: 100%;\n    box-sizing: border-box;\n    border-left: 1px solid #ccc;\n    padding: 1rem;\n"]);return p=function(){return n},n}function h(){var n=Object(c.a)(["\n    position: relative;\n    height: calc(100vh - ",");\n    display: grid;\n    grid-template-columns: 2fr 1fr;\n    box-sizing: border-box;\n    grid-gap: 0.5rem;\n\n    @media (max-width: ",") {\n        grid-template-columns: 1fr;\n    }\n"]);return h=function(){return n},n}var b,E,j=o.c.div(h(),u.e,u.a.md),O=o.c.div(p()),x=o.c.div(v(),u.a.md),w=o.c.video(g()),T=o.c.video(m(),u.a.md),y=o.c.div(f()),C=o.c.div(d()),k=o.c.div(s()),S=o.c.button(l(),u.b.blue),R=t(275),U=t(46),z=t(15),D=t(30),_=t(179),A=t(47),B=t(38),M=t(39),W=t(174),N={video:!0,audio:!0},G={iceServers:[{urls:"stun:stun.stunprotocol.org:3478"},{urls:"stun:stun.l.google.com:19302"}]},I=null,J={push:z.d};e.default=Object(D.c)((function(n){return{currentUser:n.auth.currentUser}}),J)((function(n){Object(W.a)("M\xf3j Lekarz - Chat video");var e=Object(a.useState)(!0),t=Object(i.a)(e,2),c=t[0],o=t[1],u=Object(a.useState)(!0),l=Object(i.a)(u,2),s=l[0],d=l[1],f=Object(a.useState)(!0),m=Object(i.a)(f,2),g=(m[0],m[1]),v=Object(a.useState)(!0),p=Object(i.a)(v,2),h=(p[0],p[1]),z=Object(a.useState)(!1),D=Object(i.a)(z,2),J=(D[0],D[1]),L=Object(a.useState)(),P=Object(i.a)(L,2),F=P[0],H=P[1],V=Object(a.useState)(),Y=Object(i.a)(V,2),X=(Y[0],Y[1]),q=Object(a.useRef)(null),K=Object(a.useRef)(null);Object(a.useEffect)((function(){I=setInterval((function(){(E&&"have-local-offer"===E.signalingState||!K)&&(Z(!0),console.log("staredt")),K&&K.current&&null===K.current.srcObject&&(console.log("video null"),Z(!0)),X(Date.now())}),1e3),U.f.getUser(n.match.params.id).then((function(e){200===e.status?(console.log(e.data),H(e.data),setTimeout((function(){U.g.emit("WEBRTC_JOIN",{id:n.match.params.id,audio:c,video:s})}),300)):setTimeout((function(){n.push("/")}),500)})).catch((function(e){setTimeout((function(){n.push("/")}),500)})),U.g.on("WEBRTC",(function(n){console.log(n),$(n)})),U.g.on("WEBRTC_STATUS_CHANGED",(function(e){e.id!==n.currentUser.id&&(g(e.audio),h(e.video))})),U.g.on("WEBRTC_JOINED",(function(n){J(!0),g(n.audio),h(n.video),setTimeout((function(){Z(!0)}),1500)})),U.g.on("WEBRTC_LEFT",(function(){J(!1)}));var e=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia(N).then(Q).catch(an):e?e(N,Q,an):alert("Your browser does not support getUserMedia API")}),[]),Object(a.useEffect)((function(){return function(){clearInterval(I),U.g.emit("WEBRTC_LEAVE",{id:n.match.params.id}),rn()}}),[]);var Q=function(n){console.log("get user media success"),console.log(n),b=n,q.current.srcObject=n},Z=function(n){console.log("start isCaller: "+String(n)),(E=new RTCPeerConnection(G)).onicecandidate=nn,E.ontrack=tn,E.addStream(b),n&&E.createOffer().then(en).catch(an)},$=function(n){console.log("gotMessageFromServer"),E||Z(!1),n.sdp?E.setRemoteDescription(new RTCSessionDescription(n.sdp)).then((function(){"offer"===n.sdp.type&&E.createAnswer().then(en).catch(an)})).catch(an):n.ice&&E.addIceCandidate(new RTCIceCandidate(n.ice)).catch(an)},nn=function(e){console.log("got ice candidate"),null!=e.candidate&&U.g.emit("WEBRTC_SEND",{ice:e.candidate,id:n.match.params.id})},en=function(e){console.log("created description"),E.setLocalDescription(e).then((function(){U.g.emit("WEBRTC_SEND",{sdp:E.localDescription,id:n.match.params.id})})).catch(an)},tn=function(n){console.log("got remote stream"),K.current.srcObject=n.streams[0]},an=function(n){console.log(n)},rn=function(){b&&("undefined"===typeof b.getTracks?b.stop():b.getTracks().forEach((function(n){n.stop()})),b=null),E&&(E.close(),E=null)};return r.a.createElement(j,null,r.a.createElement(x,null,E?r.a.createElement(w,{ref:K,autoPlay:!0,playsinline:!0}):F&&r.a.createElement(C,null,r.a.createElement(y,null,"Oczekiwanie na ",F.displayName,"..."),r.a.createElement(_.a,null)),r.a.createElement(T,{ref:q,autoPlay:!0,playsinline:!0})),r.a.createElement(O,null,F?r.a.createElement(r.a.Fragment,null,"Chat wideo z:",r.a.createElement(R.b,null,r.a.createElement(A.a,{url:F.avatar}),r.a.createElement(R.f,null,F.displayName)),r.a.createElement(R.c,null,"Email: ",F.email),r.a.createElement(R.a,null,"Typ konta: ","doctor"===F.accountType?"lekarz":"pacjent")):r.a.createElement(_.a,null),r.a.createElement(k,null,r.a.createElement(S,{onClick:function(){!function(){if(void 0!==b){o(!c);for(var e=b.getAudioTracks(),t=0;t<e.length;++t)e[t].enabled=!e[t].enabled;U.g.emit("WEBRTC_CHANGE_STATUS",{audio:c,video:s,id:n.match.params.id})}}()}},c?r.a.createElement(B.a,{icon:M.g}):r.a.createElement(B.a,{icon:M.h})),r.a.createElement(S,{onClick:function(){!function(){if(void 0!==b){d(!s);for(var e=b.getVideoTracks(),t=0;t<e.length;++t)e[t].enabled=!e[t].enabled;U.g.emit("WEBRTC_CHANGE_STATUS",{audio:c,video:s,id:n.match.params.id})}}()}},s?r.a.createElement(B.a,{icon:M.l}):r.a.createElement(B.a,{icon:M.m})))))}))}}]);
//# sourceMappingURL=18.305d1937.chunk.js.map